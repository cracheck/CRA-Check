using GrypeCLIWrapper;

namespace CRA_Check.Tools.VulnerabilityScanners
{
    public class GrypeScanner : IVulnerabilityScanner
    {
        private GrypeCLIWrapper.GrypeCLIWrapper _grypeCLIWrapper;

        public GrypeScanner(string grypePath)
        {
            _grypeCLIWrapper = new GrypeCLIWrapper.GrypeCLIWrapper(grypePath);
        }

        public Task<string> UpdateDatabase()
        {
            return _grypeCLIWrapper.UpdateDatabase();
        }

        public Task<string> ScanVulnerability(string sourcePath)
        {
            return _grypeCLIWrapper.ScanVulnerability(sourcePath, OutputFormatType.CYCLONEDX_JSON);
        }

        public Task<Version> GetVersion()
        {
            return _grypeCLIWrapper.GetVersion();
        }
    }
}
