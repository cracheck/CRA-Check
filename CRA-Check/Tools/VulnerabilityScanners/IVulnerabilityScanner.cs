using CRA_Check.Models;

namespace CRA_Check.Tools.VulnerabilityScanners
{
    /// <summary>
    /// Interface for vulnerabilities scanner
    /// </summary>
    public interface IVulnerabilityScanner
    {
        /// <summary>
        /// Update the vulerabilities database
        /// </summary>
        /// <returns>Return the status</returns>
        public Task<string> UpdateDatabase();

        /// <summary>
        /// Scan an SBOM for vulnerabilities
        /// </summary>
        /// <param name="sourcePath">SBOM filename</param>
        /// <returns>Scan result</returns>
        public Task<string> ScanVulnerability(string sourcePath);

        /// <summary>
        /// Scan a Release for vulnerabilities
        /// </summary>
        /// <param name="release">Release to be scanned</param>
        /// <returns>Scan result</returns
        public Task<string> ScanVulnerability(Release release);

        /// <summary>
        /// Return the Version of the scanner
        /// </summary>
        /// <returns>Version</returns>
        public Task<Version> GetVersion();
    }
}
